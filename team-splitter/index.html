<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google-adsense-account" content="ca-pub-1638183902108768">
    <title>ëœë¤ íŒ€ ë‚˜ëˆ„ê¸°</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f0f4f8;
            padding: 2rem;
            text-align: center;
        }
        h1 {
            color: #333;
        }
        textarea {
            width: 100%;
            max-width: 600px; /* ë˜ëŠ” 700px ì •ë„ */
            height: 80px;
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-radius: 10px;
            border: 1px solid #ccc;
        }
        input[type="number"] {
            padding: 0.5rem;
            border-radius: 10px;
            border: 1px solid #ccc;
            width: 100px;
        }
        button {
            padding: 0.5rem 1rem;
            border: none;
            background-color: #eee;
            color: #333;
            border-radius: 6px;
            cursor: pointer;
            margin: 0.3rem;
        }
        button:hover {
            background-color: #ccc;
        }
        table {
            width: 100%;
            margin-top: 0.5rem;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 0.5rem;
            text-align: center;
        }
        th {
            background-color: #e2f0e9;
            color: #333;
        }
        td {
            background-color: white;
        }
        .gender-section {
            display: none;
            margin-top: 1rem;
        }
        .male span, .female span {
            padding: 0.2em 0.4em;
            border-radius: 4px;
            color: black;
        }
        .male span {
            background-color: #cce5ff;
        }
        .female span {
            background-color: #ffd6e7;
        }
        .member-target-wrapper {
            display: none;
        }
        .shake {
            animation: shake 0.3s ease-in-out 2;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body>
<h1>ğŸ² ëœë¤ íŒ€ ë‚˜ëˆ„ê¸°</h1>
<label><input type="checkbox" id="genderToggle" onchange="toggleGender()" /> ì„±ë³„ë¡œ ë‚˜ëˆ„ê¸°</label>
<label style="margin-left: 1rem;"><input type="checkbox" id="memberCheckToggle" onchange="toggleMemberTarget()" /> ì¸ì› ìˆ˜ ë§ì¶”ê¸°</label>
<br /><br />
<span class="member-target-wrapper" id="memberTargetWrapper">
    <label for="memberTarget">ì°¸ê°€ì ìˆ˜:</label>
    <input type="number" id="memberTarget" min="1" placeholder="ì˜ˆ: 12" />
  </span>

<div id="defaultInput">
    <p>
        <button onclick="loadExample()">âœ¨ ì˜ˆì‹œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
    </p>
    <textarea id="nameInput" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ë„ì–´ì“°ê¸°, ì‰¼í‘œ, ì—”í„°ë¡œ êµ¬ë¶„)"></textarea>
</div>

<div class="gender-section" id="genderInput">
    <p>ğŸ‘¨ğŸ»</p>
    <textarea id="maleInput" placeholder="ë‚¨ì ì´ë¦„ë“¤"></textarea>
    <p>ğŸ‘©ğŸ»</p>
    <textarea id="femaleInput" placeholder="ì—¬ì ì´ë¦„ë“¤"></textarea>
</div>

<label>íŒ€ ìˆ˜:</label>
<input type="number" id="teamCount" min="1" oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
<button onclick="splitTeams()" style="background-color: #b6d7a8; color: #fff;">íŒ€ ë‚˜ëˆ„ê¸°</button>
<div id="csvButtonWrapper" style="display: none; text-align: right; margin-top: 1rem;">
    <button onclick="downloadCSV()">ğŸ’¾ CSV ì €ì¥</button>
</div>
<div id="result"></div>

<script>
    function toggleGender() {
        const isChecked = document.getElementById('genderToggle').checked;
        document.getElementById('defaultInput').style.display = isChecked ? 'none' : 'block';
        document.getElementById('genderInput').style.display = isChecked ? 'block' : 'none';
    }

    function toggleMemberTarget() {
        const checked = document.getElementById('memberCheckToggle').checked;
        document.getElementById('memberTargetWrapper').style.display = checked ? 'inline-block' : 'none';
    }

    function loadExample() {
        document.getElementById('nameInput').value = 'ë˜˜ê¸°, ë–µì´, í˜¸ì¹˜, ìƒˆì´ˆë¯¸, ë“œë¼ê³ , ìš”ë¡±ì´, ë§ˆì´ˆ, ë¯¸ë¯¸, ëª½ì¹˜, í‚¤í‚¤, ê°•ë‹¤ë¦¬, ì°¡ì°¡ì´';
    }

    function downloadCSV() {
        const table = document.querySelector("#result table");
        if (!table) return;

        let csv = "";
        const rows = table.querySelectorAll("tr");
        rows.forEach(row => {
            const cols = row.querySelectorAll("th, td");
            let rowData = [];
            cols.forEach(col => rowData.push(col.innerText));
            csv += rowData.join(",") + "\n";
        });

        const now = new Date();
        const timestamp = now.getFullYear().toString()
            + String(now.getMonth() + 1).padStart(2, '0')
            + String(now.getDate()).padStart(2, '0')
            + String(now.getHours()).padStart(2, '0')
            + String(now.getMinutes()).padStart(2, '0')
            + String(now.getSeconds()).padStart(2, '0');

        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `teams_${timestamp}.csv`;
        a.click();
        URL.revokeObjectURL(url);
    }

    function splitTeams() {
        const isGender = document.getElementById('genderToggle').checked;
        const checkMember = document.getElementById('memberCheckToggle').checked;
        const memberTarget = parseInt(document.getElementById('memberTarget').value);
        const teamCount = parseInt(document.getElementById('teamCount').value);
        const resultDiv = document.getElementById('result');

        let names = [];
        let genderMap = {};

        if (isGender) {
            let males = document.getElementById('maleInput').value
                .split(/[\n,\s]+/).map(n => n.trim()).filter(n => n);
            let females = document.getElementById('femaleInput').value
                .split(/[\n,\s]+/).map(n => n.trim()).filter(n => n);

            males.forEach(name => genderMap[name] = 'male');
            females.forEach(name => genderMap[name] = 'female');

            names = shuffleArray(males).concat(shuffleArray(females));
        } else {
            names = document.getElementById('nameInput').value
                .split(/[\n,\s]+/).map(n => n.trim()).filter(n => n);
            names = shuffleArray(names);
        }

        if (!teamCount || teamCount < 1 || names.length === 0) {
            resultDiv.innerHTML = '<p style="color: red;" class="shake">ì´ë¦„ê³¼ ìœ íš¨í•œ íŒ€ ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>';
            return;
        }

        if (checkMember && memberTarget) {
            const diff = names.length - memberTarget;
            if (diff > 0) {
                resultDiv.innerHTML = `<p style="color: red;" class="shake">${diff}ëª… ë” ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.</p>`;
                return;
            } else if (diff < 0) {
                resultDiv.innerHTML = `<p style="color: red;" class="shake">${-diff}ëª… ë¶€ì¡±í•©ë‹ˆë‹¤.</p>`;
                return;
            }
        }

        const teams = Array.from({ length: teamCount }, () => []);
        names.forEach((name, index) => {
            teams[index % teamCount].push(name);
        });

        const maxLength = Math.max(...teams.map(team => team.length));
        let html = '<table><tr>';
        for (let i = 0; i < teamCount; i++) {
            html += `<th>íŒ€ ${i + 1}</th>`;
        }
        html += '</tr>';

        for (let row = 0; row < maxLength; row++) {
            html += '<tr>';
            for (let col = 0; col < teamCount; col++) {
                const name = teams[col][row] || '';
                const genderClass = genderMap[name] || '';
                const content = genderClass ? `<span class="${genderClass}"><span>${name}</span></span>` : name;
                html += `<td>${content}</td>`;
            }
            html += '</tr>';
        }
        html += '</table>';

        resultDiv.innerHTML = html;
        document.getElementById('csvButtonWrapper').style.display = 'block';
    }

    function shuffleArray(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    window.addEventListener('DOMContentLoaded', () => {
        document.getElementById('memberTargetWrapper').style.display = 'none';
    });
</script>
</body>
</html>
